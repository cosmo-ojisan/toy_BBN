# 빅뱅 핵합성(BBN) 토이 모델 해설서

## 학생용 완전 해설 가이드 (고1 통합과학 수준)

이 문서는 고등학교 통합과학의 '우주 초기에 생성된 원소' 내용을 바탕으로,
빅뱅 핵합성(Big Bang Nucleosynthesis, BBN)을 파이썬 코드로 구현하는 과정을 **교과서 수준으로 상세히** 설명한다. 따라서 수학적 도구와 물리적 개념을 함께 다룬다.

> **주의:** 이 프로젝트는 **교육용 토이 모델**이다. 정밀한 수치 예측보다는 물리적 개념의 이해가 목표이다.

> **범위:** 이 프로젝트는 빅뱅 이후 약 0.01초부터 ~20분까지를 다룬다. "빅뱅 이전에 무엇이 있었는가?"는 우주론의 미해결 문제이며, 이 토이 모델의 범위 밖이다.

---

# 들어가기 전에: 이 문서를 읽는 법

## 수학 기호에 대한 안내

이 문서에서 자주 등장하는 기호들을 미리 정리한다:

| 기호 | 의미 | 읽는 법 |
|-----|------|--------|
| $\Delta t$ | 시간의 변화량 | "델타 t" |
| $\Delta x$ | x의 변화량 | "델타 x" |
| $\propto$ | 비례한다 | "비례" |
| $e$ | 자연상수 (약 2.718) | "이" |
| $\exp(x)$ | $e^x$와 같음 | "익스포넨셜 x" |

### $\Delta$ (델타)의 의미

그리스 문자 델타($\Delta$)는 **"변화량"** 또는 **"차이"**를 나타낸다.

$$\Delta t = t_{\text{나중}} - t_{\text{처음}}$$

예를 들어:
- 처음 시각이 10초, 나중 시각이 15초라면
- $\Delta t = 15 - 10 = 5$초 (5초 동안의 시간 변화)

이것은 중학교에서 배운 **"변화량 = 나중 값 - 처음 값"**과 정확히 같다!

---

# 제1장. 빅뱅과 초기 우주

## 1.1 빅뱅이란?

약 138억 년 전, 우주는 극도로 뜨겁고 밀도가 높은 상태에서 시작되었다. 이를 **빅뱅(Big Bang)**이라고 한다.

빅뱅 직후 우주는:
- **온도:** 수십억 도 이상 (핵융합이 가능한 온도)
- **밀도:** 현재보다 훨씬 높음
- **상태:** 원자가 존재할 수 없는 플라즈마 상태

## 1.2 우주의 팽창과 냉각

빅뱅 이후 우주는 계속 팽창하고 있다. 그리고 팽창하면서 냉각된다.

**핵심 관계:**
$$T \propto \frac{1}{a}$$

여기서 $a$는 우주의 크기(스케일 팩터)이다. 따라서:

- 우주가 **2배** 커지면 → 온도는 **1/2**로 떨어진다
- 또한 우주가 **100배** 커지면 → 온도는 **1/100**로 떨어진다

이것은 중학교에서 배운 **반비례 관계**와 정확히 같다!

## 1.3 플라즈마 상태

온도가 충분히 높으면 원자가 존재할 수 없다. 왜냐하면 전자가 원자핵에 붙어 있지 못하고 분리되기 때문이다. 이렇게 전자와 원자핵이 분리된 상태를 **플라즈마**라고 한다.

## 1.4 온도와 에너지: 화폐 환전 비유 ★★★

> **핵심 비유:** 온도를 에너지로 바꾸는 것은 **환전**과 같다!

물리학에서는 온도를 에너지로 환산해서 사용하는 것이 편리하다.
마치 해외여행 갈 때 원화를 달러로 환전하는 것처럼!

### 환전 비유

| 상황 | 환전 전 | 환율 | 환전 후 |
|-----|--------|------|--------|
| 해외여행 | 1,300원 | ÷1,300원/달러 | 1달러 |
| **물리학** | **11,600 K** | **×볼츠만 상수** | **1 eV** |

**볼츠만 상수**는 온도(K)를 에너지(eV)로 바꿔주는 **"환율"**이다!

$$k_B = 8.617 \times 10^{-5} \text{ eV/K}$$

### 쉬운 어림셈

복잡한 계산 대신, 이것만 기억하자:

> **1 eV ≈ 11,600 K ≈ 약 1만 도**

| 에너지 (eV) | 온도 (K) | 쉽게 말하면 |
|------------|---------|------------|
| 0.1 eV | 약 1,000 K | 천 도 |
| 1 eV | 약 11,600 K | **만 도** |
| 10 eV | 약 116,000 K | 십만 도 |
| 1 MeV | 약 10¹⁰ K | **100억 도** |

### 왜 eV를 쓰는가?

우선 그 이유를 살펴보자:
- 켈빈(K) 숫자가 너무 커서 불편 (10억, 100억...)
- 또한 입자물리에서는 eV(전자볼트)가 표준 화폐
- 참고로 1 MeV = 100만 eV = 약 100억 도

**예시:** "동결 온도 1 MeV" = "약 100억 도에서 동결"

## 1.5 시간-온도 관계 (토이 모델)

이 프로젝트에서는 시간과 온도의 관계를 다음과 같이 단순화한다:

$$t(T) = \frac{A}{T^2}$$

여기서 $A$는 상수이다.

**의미:**
- 온도가 **2배** 낮아지면 → $T^2$은 **4배** 작아지고 → 따라서 시간 $t$는 **4배** 증가
- 마찬가지로 온도가 **10배** 낮아지면 → $T^2$은 **100배** 작아지고 → 결국 시간 $t$는 **100배** 증가

---

# 제2장. 중성자와 양성자

## 2.1 핵자(Nucleon)란?

원자핵을 구성하는 입자를 **핵자**라고 한다. 그런데 핵자에는 두 종류가 있으며, 이 구분이 BBN에서 중요한 역할을 한다:

| 입자 | 기호 | 전하 | 질량 |
|-----|-----|-----|-----|
| 양성자 (proton) | p | +1 | 938.3 MeV/c² |
| 중성자 (neutron) | n | 0 | 939.6 MeV/c² |

**중요:** 중성자는 양성자보다 약간 더 무겁다!
$$Q = m_n - m_p \approx 1.293 \text{ MeV}$$

> 🔴 **블랙박스:** 이 값은 PDG(Particle Data Group)의 측정값이다. 즉, 이론적 유도가 아니라 실험에서 직접 측정한 값이다.

바로 이 질량 차이가 BBN에서 매우 중요한 역할을 한다. 왜냐하면 이 차이가 평형 상태의 n/p 비를 결정하기 때문이다.

## 2.2 중성자 분율 $X_n$

전체 핵자 중 중성자의 비율을 **중성자 분율**이라고 한다:

$$X_n = \frac{n}{n + p} = \frac{\text{중성자 수}}{\text{전체 핵자 수}}$$

**예시:**
- 예를 들어, 중성자 20개, 양성자 80개가 있다면
- $X_n = \frac{20}{20+80} = \frac{20}{100} = 0.20$ (20%)

## 2.3 중성자-양성자 비 $n/p$

중성자와 양성자의 개수 비율:

$$\frac{n}{p} = \frac{\text{중성자 수}}{\text{양성자 수}}$$

**$X_n$과 $n/p$의 관계:**

$$\frac{n}{p} = \frac{X_n}{1 - X_n}$$

**역변환:**

$$X_n = \frac{n/p}{1 + n/p}$$

**예시:**
- $X_n = 0.125$ (1/8)일 때
- $n/p = \frac{0.125}{1-0.125} = \frac{0.125}{0.875} = \frac{1}{7}$

> **주의:** 이 관계는 **비선형**이다! $X_n$이 2배가 된다고 $n/p$도 2배가 되지 않는다.

## 2.4 평형 상태에서의 n/p 비

고온에서 중성자와 양성자는 서로 빠르게 전환된다. 따라서 **열평형** 상태에 있다.
그렇다면 평형에서의 $n/p$ 비는 어떻게 결정될까? 사실 이는 통계역학의 결과로, 볼츠만 분포를 따른다:

$$\left(\frac{n}{p}\right)_{\text{eq}} = e^{-Q/T}$$

**온도에 따른 평형 n/p 비:**

| 온도 T | 환산 | Q/T | $e^{-Q/T}$ | 의미 |
|--------|------|-----|-----------|------|
| 10 MeV | 1000억 도 | 0.13 | 0.88 | 거의 1:1 |
| 1 MeV | 100억 도 | 1.29 | 0.27 | 중성자가 적어짐 |
| 0.1 MeV | 10억 도 | 12.9 | 0.0000025 | 중성자 거의 없음 |

**핵심:** 온도가 낮아지면 무거운 쪽(중성자)이 **불리해진다**. 그 결과 n/p가 작아진다! 다시 말해, 열평형 상태에서는 에너지가 낮은 쪽이 유리하다.

---

# 제3장. 핵반응과 보존법칙

## 3.1 핵종의 표기

핵종은 양성자 수(Z)와 질량수(A)로 표기한다:

$${}^A_Z X$$

| 핵종 | 기호 | 양성자 수 (Z) | 중성자 수 (N) | 질량수 (A=Z+N) |
|-----|-----|-------------|-------------|--------------|
| 양성자 | p | 1 | 0 | 1 |
| 중성자 | n | 0 | 1 | 1 |
| 중수소 | D | 1 | 1 | 2 |
| 헬륨-3 | He-3 | 2 | 1 | 3 |
| 헬륨-4 | He-4 | 2 | 2 | 4 |

## 3.2 보존법칙

핵반응에서는 두 가지가 반드시 보존된다. 물론 이는 화학 반응에서 원자가 보존되는 것과 유사하다:

**1. 질량수 보존 (A):**
$$\sum A_{\text{반응물}} = \sum A_{\text{생성물}}$$

**2. 전하 보존 (Z):**
$$\sum Z_{\text{반응물}} = \sum Z_{\text{생성물}}$$

**예시: D + D → He-3 + n**

예를 들어 이 반응의 보존을 확인해 보자:
- 반응 전 질량수: 2 + 2 = 4
- 반응 후 질량수: 3 + 1 = 4 ✓
- 또한 반응 전 전하: 1 + 1 = 2
- 그리고 반응 후 전하: 2 + 0 = 2 ✓

## 3.3 주요 핵반응

그렇다면 BBN에서 실제로 일어나는 주요 반응들은 무엇일까?

**1단계: 중수소 생성**
$$p + n \to D + \gamma$$

우선 양성자와 중성자가 결합하여 중수소(D)가 된다.

**2단계: 헬륨-3 생성**

그 다음으로 중수소가 모이면 헬륨-3이 생성된다:
$$D + D \to {}^3\text{He} + n$$
$$D + p \to {}^3\text{He} + \gamma$$

**3단계: 헬륨-4 생성**

마지막으로 헬륨-3가 헬륨-4로 변환된다:
$${}^3\text{He} + n \to {}^4\text{He} + \gamma$$

> **주의:** 그러나 D + D → He-4 반응은 광자(γ) 없이는 운동량 보존 때문에 직접 일어나기 어렵다!

---

# 제4장. 자연의 기본 힘과 약력

## 4.1 네 가지 기본 힘 (심화 내용)

자연에는 네 가지 기본 힘이 있다:

| 힘 | 작용 대상 | 상대적 세기 | 도달 거리 |
|---|----------|-----------|----------|
| **강력(핵력)** | 쿼크, 핵자 | 1 | $10^{-15}$ m |
| **전자기력** | 전하를 가진 입자 | $10^{-2}$ | 무한대 |
| **약력** | 모든 페르미온 | $10^{-5}$ | $10^{-18}$ m |
| **중력** | 모든 질량 | $10^{-40}$ | 무한대 |

## 4.2 핵력 (강력)

핵력은 양성자와 중성자를 원자핵 안에 **묶어두는** 힘이다.

- 양성자끼리는 전기적으로 밀어낸다. 그러나 핵력이 더 강해서 핵이 안정하다
- 또한 **도달 거리가 매우 짧음** → 원자핵 크기($10^{-15}$ m) 내에서만 작용
- 결국 핵융합과 핵분열은 바로 이 핵력에 의해 일어난다

## 4.3 약력 (약한 상호작용) ★★★

약력은 BBN을 이해하는 데 **핵심적인** 힘이다! 왜냐하면 바로 이 힘이 중성자와 양성자의 전환을 담당하기 때문이다.

**약력의 특징:**
- 입자의 **종류(flavor)**를 바꿀 수 있는 **유일한** 힘
- 그리고 **중성자 ↔ 양성자 전환**을 담당!
- 또한 도달 거리가 매우 짧음 ($10^{-18}$ m)

**중성자-양성자 전환 반응:**

**n → p 반응 (중성자 → 양성자):**
- $n + \nu \to p + e^-$ (중성미자 포획)
- $n + e^+ \to p + \bar{\nu}$ (양전자 포획)
- $n \to p + e^- + \bar{\nu}$ (자유 붕괴, 반감기 ~10분)

**p → n 반응 (양성자 → 중성자):**
- 반대로 $p + e^- \to n + \nu$
- 그리고 $p + \bar{\nu} \to n + e^+$

**핵심:** 고온에서는 이 반응들이 빨라서 평형을 유지한다. 그러나 저온에서는 느려져서 "동결"이 일어난다! 사실 이 동결이 바로 BBN의 핵심 현상이다.

## 4.4 중성자 붕괴

한편, 자유 중성자는 불안정하여 자연적으로 붕괴한다:

$$n \to p + e^- + \bar{\nu}_e$$

> 🔴 **블랙박스:** 이 수명값은 실험 측정치이다 (PDG 2022).

- 반감기: $t_{1/2} \approx 10.2$ 분 (612초)
- 평균 수명: $\tau_n \approx 879$ 초 (PDG 2022: 878.4±0.5초)

물론 이 붕괴도 **약력**에 의해 일어난다!

---

# 제5장. 반감기와 지수감쇠

## 5.1 반감기란?

**반감기**($t_{1/2}$)는 물질의 양이 처음의 절반으로 줄어드는 데 걸리는 시간이다.

**반감기 후 남은 양:**
$$N(t) = N_0 \times \left(\frac{1}{2}\right)^{t/t_{1/2}}$$

**예시: 중성자 (반감기 ~10분)**
| 시간 | 남은 비율 | 계산 |
|-----|----------|------|
| 0분 | 100% | $(1/2)^0 = 1$ |
| 10분 | 50% | $(1/2)^1 = 0.5$ |
| 20분 | 25% | $(1/2)^2 = 0.25$ |
| 30분 | 12.5% | $(1/2)^3 = 0.125$ |

이처럼 반감기가 지날 때마다 양이 절반으로 줄어든다. 그래서 3번의 반감기가 지나면 원래의 1/8만 남게 된다.

## 5.2 자연상수 e와 지수함수 ★★★

> **수학적 배경:** 고2 수학 I에서 배우는 내용이지만, 직관적으로 이해할 수 있다!

### e가 뭐야? - 그래프로 이해하기

자연상수 $e \approx 2.718$은 **"자연스러운 성장과 감소"**를 나타내는 특별한 수이다.

**지수감쇠 그래프의 특징:**
```
1.0 |*
    | *
0.5 |   *
    |     *
    |        *
0.0 +----------> 시간
```

이 "미끄럼틀 같은 곡선"이 자연계에서 줄어드는 현상에 흔히 나타난다. 예를 들어:
- 방사성 붕괴
- 약이 몸에서 빠져나가는 과정
- 뜨거운 물이 식는 과정

만일 이 곡선 형태를 잘 이해하면, BBN의 수치 결과도 직관적으로 이해할 수 있다.

### 반감기 공식을 e로 바꾸면?

$$N(t) = N_0 \times \left(\frac{1}{2}\right)^{t/t_{1/2}} = N_0 \times e^{-t/\tau}$$

> **마이너스의 의미:** 지수에 마이너스(-)가 붙으면 "줄어든다"는 뜻이다. 시간 $t$가 커질수록 $e^{-t/\tau}$는 작아진다.

여기서 **평균 수명** $\tau$와 반감기의 관계:
$$\tau = \frac{t_{1/2}}{\ln 2} \approx 1.443 \times t_{1/2}$$

### 왜 e를 쓰는가?

| 표현 | 장점 | 단점 |
|-----|------|------|
| $(1/2)^{t/t_{1/2}}$ | 직관적 (반씩 줄어듦) | 미분/적분이 복잡 |
| $e^{-t/\tau}$ | 미분/적분이 간단 | 직관적이지 않음 |

**결론:** 계산할 때는 $e$가 편하고, 이해할 때는 "반감기마다 반토막"이 편하다! 그래서 이 교재에서는 상황에 따라 두 표현을 혼용한다.

### 코드에서 exp()의 의미

```python
import math
math.exp(-t/tau)  # = e^(-t/τ) = (1/2)^(t/t_half) 와 같은 값!
```

---

# 제6장. 거듭제곱과 스케일링

## 6.1 거듭제곱이란?

$$T^5 = T \times T \times T \times T \times T$$

거듭제곱의 성질:
- $T$가 **2배**가 되면 → $T^5$는 $2^5 = 32$배
- $T$가 **1/2배**가 되면 → $T^5$는 $(1/2)^5 = 1/32$배

## 6.2 반응률의 온도 의존성

먼저 **반응률(reaction rate)**이란 단위 시간당 반응이 일어나는 횟수다. 반응률이 크면 반응이 빠르게 진행된다.

약한 반응률 $\Gamma$는 온도의 5제곱에 비례한다:

$$\Gamma(T) = \gamma_0 \times T^5$$

> 🔴 **블랙박스:** 이 관계는 양자장론(Fermi 이론)에서 유도된다. 여기서는 결과만 사용한다.

**의미:**
- 온도가 **10배** 낮아지면 → $\Gamma$는 $10^5 = 100,000$배 작아진다!
- 따라서 **저온에서는 반응이 매우 느려진다**
- 다시 말해, 온도가 조금만 떨어져도 반응률은 급격히 감소한다

## 6.3 팽창률의 온도 의존성

허블 팽창률 $H$는:
$$H \propto T^2$$

> 🔴 **블랙박스:** 이 관계는 일반상대론(프리드만 방정식)에서 유도된다. 여기서는 결과만 사용한다.

**의미:**
- 온도가 **10배** 낮아지면 → $H$는 **100배** 작아진다
- 그러나 $\Gamma$는 **100,000배** 작아진다 (1000배 더 많이 줄어듦!)
- 결국 저온에서는 $\Gamma < H$가 된다!
- 이것이 바로 동결이 일어나는 이유이다

---

# 제7장. 무차원비 Γ/H와 동결 ★★★

## 7.1 무차원비란?

**무차원비**는 단위가 없는 비율이다.

$$\frac{\Gamma}{H} = \frac{\text{반응률 [1/초]}}{\text{팽창률 [1/초]}} = \text{단위 없음}$$

단위가 없으므로 **1과 직접 비교**할 수 있다! 즉, "크다/작다"가 바로 물리적 의미를 갖는다.

## 7.2 Γ/H의 의미

| Γ/H 값 | 의미 | 결과 |
|--------|------|------|
| Γ/H >> 1 | 반응이 팽창보다 훨씬 빠름 | 평형 유지 |
| Γ/H ≈ 1 | 반응과 팽창이 비슷 | 임계점 |
| Γ/H << 1 | 팽창이 반응보다 훨씬 빠름 | 평형 깨짐 (동결) |

## 7.3 동결(Freeze-out)의 악수 게임 비유 ★★★

> **핵심 비유:** 팽창하는 우주는 "서로 멀어지는 두 사람", 핵반응은 "악수"!

### 악수 게임으로 이해하는 동결

두 사람이 서로 마주보고 악수를 하려고 한다. 그런데 바닥이 양쪽으로 늘어나고 있다! 이 비유를 통해 동결 현상을 직관적으로 이해할 수 있다.

**상황 1: 고온 (반응이 빠름)**
- 두 사람이 가까이 있어서 **1초에 100번** 악수 가능
- 바닥이 늘어나도 금방 다시 다가가서 악수
- 즉, 언제든 원하는 만큼 악수할 수 있음 → **평형 유지**

**상황 2: 온도가 내려감 (반응이 느려짐)**
- 반응 속도가 느려져서 **1초에 10번**만 악수 가능
- 바닥 팽창 속도는 비슷

**상황 3: 동결 순간**
- 결국 팔 길이보다 멀어지는 순간이 온다
- 그러면 마지막으로 잡았던 손을 **놓치게 됨**
- 따라서 더 이상 악수할 수 없이 그 상태 그대로 **굳어버림**

### 핵심 깨달음

> **동결은 "식어서 굳는 것"이 아니라 "멀어져서 반응이 끊기는 것"이다!**

다시 말해서:
- ❌ 잘못된 직관: "차가워져서 움직임이 멈춤"
- ✅ 올바른 이해: "팽창 때문에 입자들이 너무 멀어져서 반응할 수 없게 됨"

사실 많은 학생들이 "동결"이라는 단어 때문에 "얼어붙는다"고 오해한다. 하지만 핵심은 **속도 비교**이다.

### 비유와 실제 물리의 대응

| 악수 게임 비유 | 실제 BBN 물리 |
|---------------|---------------|
| 두 사람 | 중성자와 양성자 (또는 반응 대상 입자들) |
| 악수 | 핵반응 (n↔p 전환) |
| 악수 속도 | 반응률 Γ |
| 바닥 팽창 속도 | 허블 팽창률 H |
| 팔 길이 | 핵력 도달 거리 (~10⁻¹⁵ m) |
| 손을 놓침 | 동결 (freeze-out) |

> **비유의 한계:** 이 비유는 "속도 비교"의 핵심을 전달하지만, 실제로는 수십억 개의 입자가 동시에 반응한다. 또한 양자역학적 효과는 비유에 포함되지 않는다.

### 그래프에서 동결 찾기

n/p vs T 그래프에서 동결을 어떻게 찾을 수 있는가?
- **실선(실제)이 점선(평형)을 따라가면:** 악수가 잘 되는 중 (Γ/H > 1)
- **실선이 점선에서 벗어나기 시작하면:** 손이 닿을락말락 (Γ/H ≈ 1)
- **실선이 평평해지면:** 손을 놓침, 동결 완료 (Γ/H < 1)

이처럼 그래프의 모양 변화가 물리적 상태 변화를 반영한다.

## 7.4 동결 온도

그렇다면 실제 BBN에서 동결이 일어나는 온도는 얼마인가?
- **약 0.7~1 MeV** (약 70억~100억 도)
- 이때 n/p ≈ 1/6 ~ 1/5

그러나 동결 후에도 중성자는 천천히 붕괴한다. 이 때문에 핵합성 시작 시점에는 n/p ≈ 1/7이 된다. 물론 이 값은 핵합성이 언제 시작하느냐에 따라 달라질 수 있다.

---

# 제8장. 헬륨 질량비 Yp = 2Xn

## 8.1 제한 반응물

He-4 하나를 만들려면:
- 양성자 2개 + 중성자 2개가 필요하다

그런데 초기 우주에서:
- 양성자가 중성자보다 **훨씬 많음** (n/p ≈ 1/7)
- 따라서 **중성자가 제한 반응물**이다
- 이는 화학에서 배운 제한 반응물 개념과 정확히 같다

다시 말해, 중성자가 다 소모될 때까지만 He-4가 생성된다. 그래서 최종 헬륨 양은 중성자 수에 의해 결정된다.

## 8.2 연립방정식으로 Yp 유도

먼저 전체 핵자수를 1로 정규화하자:

**식 1: 핵자수 보존**
$$1 = N_H + 4 \times N_{He}$$

**식 2: 중성자 보존**
$$X_n = 2 \times N_{He}$$

이 두 식을 연립하여 풀면:
- $N_{He} = \frac{X_n}{2}$
- 또한 $N_H = 1 - 2X_n$

따라서 **헬륨 질량비:**
$$Y_p = 4 \times N_{He} = 4 \times \frac{X_n}{2} = 2X_n$$

## 8.3 관측값과 비교

실제 관측 결과와 비교해 보자:
- 관측된 우주의 He-4 질량비: $Y_p \approx 0.24$
- 이로부터 역산하면: $X_n \approx 0.12$
- 그리고 이는 n/p ≈ 1/7 ≈ 0.14에 해당한다

즉, 토이 모델의 예측과 실제 관측이 대략적으로 일치한다!

**왜 이것이 중요한가?** 만일 빅뱅이 없었다면, 우주의 헬륨 비율은 전혀 달랐을 것이다. 예를 들어, 별 내부에서만 헬륨이 만들어졌다면 그 양은 훨씬 적었을 것이다. 따라서 우주 전체에서 ~25%라는 일관된 헬륨 비율이 관측된다는 사실 자체가 빅뱅의 강력한 증거다.

**이 프로젝트의 결과:**
- 토이 모델로 계산한 $Y_p$가 약 **0.24-0.25** 근방으로 나온다
- 따라서 관측값과 **대략적으로 일치**함을 확인할 수 있다!

---

# 제9장. 수치 적분: 오일러 방법 ★★★

## 9.1 거속시 공식에서 시작하기

> **핵심 아이디어:** 오일러 방법은 초등학교 "거리 = 속력 × 시간"의 확장이다!

### 초등학교 공식

$$\text{거리} = \text{속력} \times \text{시간}$$

### 조금 바꿔서

$$\text{미래 위치} = \text{현재 위치} + \text{속력} \times \text{시간}$$

### 기호로 쓰면

$$x_{\text{다음}} = x_{\text{현재}} + v \times \Delta t$$

여기서 $\Delta t = t_{\text{다음}} - t_{\text{현재}}$ (시간 변화량)

### 일반화하면 (오일러 방법)

$$x_{\text{다음}} = x_{\text{현재}} + (\text{변화율}) \times \Delta t$$

**이것이 바로 오일러 방법이다!**

## 9.2 영화 프레임 비유

오일러 방법은 **영화 촬영**과 비슷하다!

| 영화 | 오일러 방법 |
|-----|------------|
| 1초에 30프레임 촬영 | $\Delta t$ 간격으로 계산 |
| 프레임 수 n | 시간 스텝 n |
| 총 시간 = n × (프레임 간격) | $t = n \times \Delta t$ |
| 프레임 간격이 짧을수록 부드러움 | $\Delta t$가 작을수록 정확함 |

### 네비게이션 비유

오일러 방법은 **차량 네비게이션의 예측 경로**와 같다:
- 현재 위치와 현재 속도만 보고 "앞으로 10초 후 여기 있겠네" 예측
- 10초 후 실제 위치에서 다시 예측
- 이 과정을 반복하면 대략적인 경로가 나옴
- 결과적으로 **예측 간격(Δt)이 짧을수록 정확**해짐

## 9.3 BBN에서의 오일러 방법

중성자 분율 $X_n$의 변화:

$$X_{n,\text{다음}} = X_{n,\text{현재}} + (\text{변화율}) \times \Delta t$$

여기서:
- $\Delta t = t_{\text{다음}} - t_{\text{현재}}$ (시간 간격)
- 변화율 = 반응에 의한 변화 + 붕괴에 의한 변화

## 9.4 왜 단순 오일러가 고온에서 실패하는가?

그런데 **문제**가 있다. 만일 고온에서 $\Gamma$가 매우 크면:
- $\Gamma \times \Delta t$가 1보다 훨씬 커질 수 있다
- 그 결과 계산 결과가 진동하거나 발산한다!
- 이것은 수치 불안정성(numerical instability)이라고 한다

**비유:** 예를 들어 네비게이션이 "10분 후 예측"을 하는데, 차가 1분 만에 목적지를 지나쳐 버리는 상황과 같다. 다시 말해, 변화가 너무 빠르면 예측이 실패한다

## 9.5 지수 완화 (해결책)

이 문제를 해결하기 위해 해석적 해를 사용한다:
$$X_{n,\text{다음}} = X_{n,\text{평형}} + (X_n - X_{n,\text{평형}}) \times e^{-\Gamma \times \Delta t}$$

**왜 안정적인가?** 그 이유는 다음과 같다:
- $e^{-\Gamma \times \Delta t}$는 **항상 0과 1 사이**이다
- 따라서 $\Gamma \times \Delta t$가 아무리 커도 발산하지 않는다
- 이처럼 해석적 해를 활용하면 수치 안정성을 확보할 수 있다

## 9.6 코드 예시

```python
# 거속시 공식 (초등학교)
거리 = 속력 * 시간

# 오일러 방법 (고등학교)
x_next = x + rate * delta_t

# BBN 시뮬레이션 (지수 완화)
Xn_next = Xn_eq + (Xn - Xn_eq) * math.exp(-Gamma * delta_t)
```

---

# 제10장. 그래프 읽기

## 10.0 지수함수와 로그함수의 그래프 (선택 읽기)

BBN 시뮬레이션에서 사용하는 지수함수와 로그함수의 기본 특성을 알아보자.

### 지수함수 $y = a^x$ (a > 1)

| 특징 | 설명 |
|------|------|
| **지나는 점** | 항상 (0, 1)을 지남 ($a^0 = 1$) |
| **점근선** | x축 (y = 0)이 점근선 |
| **특성** | x가 커지면 y가 **폭발적**으로 증가 |
| **예시** | $y = 2^x$는 (0,1), (1,2), (2,4), (3,8)... |

```
y
↑    ╱
│   ╱
│  ╱
│ ╱     ← 빠르게 증가
│╱
└──────→ x
  y = 2^x
```

### 로그함수 $y = \log_a x$ (a > 1)

| 특징 | 설명 |
|------|------|
| **지나는 점** | 항상 (1, 0)을 지남 ($\log_a 1 = 0$) |
| **점근선** | y축 (x = 0)이 점근선 |
| **특성** | x가 커져도 y는 **천천히** 증가 |
| **예시** | $y = \log_2 x$는 (1,0), (2,1), (4,2), (8,3)... |

```
y
↑   ___
│  ╱
│ ╱       ← 천천히 증가
│╱
│
└────────→ x
  y = log₂x
```

### 역함수 관계: $y = a^x$ 와 $y = \log_a x$

이 두 함수는 **역함수** 관계이다. 그래프는 **y = x 직선에 대해 대칭**!

```
y        y=x
↑       ╱
│   ╱  ╱  ← y = 2^x
│  ╱ ╱
│ ╱╱
│╱╱____  ← y = log₂x
└──────────→ x
```

**수학적으로:**
- $2^3 = 8$ ⟺ $\log_2 8 = 3$
- 지수와 로그는 "역연산" (곱셈 ↔ 나눗셈처럼)

---

## 10.0.1 로그 스케일이란? ★★★

### 왜 로그 스케일이 필요한가?

과학 데이터는 종종 **여러 자릿수(orders of magnitude)**에 걸쳐 있다:

| 예시 | 범위 | 배율 |
|-----|------|-----|
| BBN 시간 | 0.001초 ~ 1000초 | 100만 배 |
| 반응률 Γ | 0.001 ~ 100000 | 1억 배 |
| 지진 에너지 | 매우 작음 ~ 매우 큼 | 수십억 배 |

**문제:** 일반(선형) 그래프에서는 작은 값이 안 보인다!

### 로그 스케일의 원리

로그 스케일에서는 **10배씩 같은 간격**으로 표시한다:

```
선형 스케일:  |----|----|----|----|
             0   25   50   75  100

로그 스케일:  |---------|---------|---------|
             1        10       100      1000
           (10^0)   (10^1)   (10^2)   (10^3)
```

### 세 가지 스케일 비교

| 스케일 | x축 | y축 | 직선이 되는 관계 | 사용 예 |
|--------|-----|-----|-----------------|---------|
| **선형** | 선형 | 선형 | $y = ax + b$ | 일반 데이터 |
| **semilog** | 선형 | **로그** | $y = b \cdot e^{ax}$ | 지수감쇠, 세균증식 |
| **log-log** | **로그** | **로그** | $y = bx^a$ | 멱법칙, 스케일링 |

### 핵심: "로그 스케일에서 직선 = 특별한 관계"

> **semilog에서 직선** → 지수 관계 ($y \propto e^x$)
> **log-log에서 직선** → 멱법칙 관계 ($y \propto x^n$)

### BBN에서의 활용

BBN 시뮬레이션 그래프에서:
- `plt.xscale('log')`: x축을 로그 스케일로
- `plt.semilogy()`: y축만 로그 스케일로
- `plt.loglog()`: 양축 모두 로그 스케일로

**예: n/p vs T 그래프**
- x축(온도): 10 MeV ~ 0.1 MeV (100배 범위)
- y축(n/p): 1 ~ 0.001 (1000배 범위)
- 로그 스케일을 쓰면 모든 구간을 명확하게 볼 수 있다!

---

## 10.1 시간-온도 그래프 T(t)

- **x축:** 시간 t (로그 스케일)
- **y축:** 온도 T
- **해석:** 시간이 지날수록 온도가 내려감

## 10.2 n/p vs T 그래프

- **x축:** 온도 T (로그 스케일, 왼쪽이 고온)
- **y축:** n/p 비 (로그 스케일)
- **실선:** 실제 계산된 n/p
- **점선:** 평형 n/p

**해석 (악수 게임 비유 적용):**
- 고온(왼쪽): 실선이 점선을 따라감 → 악수가 잘 됨
- 어느 온도: 실선이 점선에서 벗어남 → 손이 닿을락말락
- 저온(오른쪽): 실선이 거의 일정 → 손을 놓음 (동결)

## 10.3 Γ/H vs T 그래프

- **기준선:** Γ/H = 1
- Γ/H > 1인 영역: 반응 우세, 따라서 평형 유지
- Γ/H < 1인 영역: 팽창 우세, 따라서 동결

## 10.4 Xn vs t 그래프

- **초반:** Xn이 빠르게 감소 (평형 따라감)
- **동결 후:** Xn이 천천히 감소 (중성자 붕괴만 남음)
- **마지막 값:** $Y_p = 2X_n$으로 헬륨 비율 결정

결국 이 그래프의 최종값이 우주의 헬륨 함량을 결정한다.

---

# 제11장. 시뮬레이션 전체 흐름

## 11.1 한 스텝 업데이트

```
1. 시간 간격 계산
   Δt = t_다음 - t_현재
   (t = A / T² 로부터 계산)

2. 중간점 온도 계산
   T_mid = √(T_이전 × T_현재)

3. 반응률 계산
   Γ = γ₀ × T_mid⁵

4. 평형값 계산
   X_eq = (n/p)_eq / (1 + (n/p)_eq)
   (n/p)_eq = exp(-Q/T_mid)

5. 지수 완화로 약한 반응 적용
   X_temp = X_eq + (X_n - X_eq) × exp(-Γ × Δt)

6. 중성자 붕괴 적용
   X_다음 = X_temp × exp(-Δt / τ_n)
```

## 11.2 전체 시뮬레이션

```
1. 초기 조건 설정
   - T_start = 10 MeV (고온, 약 1000억 도)
   - T_nuc = 0.07 MeV (핵합성 온도, 약 7억 도)
   - X_n = X_eq(T_start)

2. 온도 격자 생성
   - T_start에서 T_nuc까지 로그 스케일로 분할

3. 각 스텝마다 반복
   - step_Xn() 함수로 X_n 업데이트
   - 결과 저장

4. 최종 결과
   - Y_p = 2 × X_n(T_nuc)
```

---

# 제12장. 세 가지 핵심 질문과 답 ★★★ 필수

## 질문 1: 왜 고온에서는 n/p가 "평형"을 따라가나?

**답 (악수 게임 비유):**
- 고온에서는 두 입자가 가까이 있고, 반응(악수)이 매우 빠름
- 1초에 수천 번 악수할 수 있어서, 언제든 원하는 상태로 갈 수 있음
- Γ/H >> 1 → 반응이 팽창보다 훨씬 빠름 → 평형 유지

## 질문 2: 왜 어떤 시점부터 평형이 깨지고 "동결"되나?

**답 (악수 게임 비유):**
- 온도가 내려가면 반응 속도 Γ ∝ T⁵가 급격히 감소
- 어느 순간 팔 길이(반응 범위)보다 멀어짐
- 마지막으로 잡았던 손을 놓치고, 그 상태로 굳어버림
- **"식어서 굳는 것"이 아니라 "멀어져서 반응이 끊기는 것"**
- 동결 온도: 약 1 MeV (100억 도)

## 질문 3: 왜 마지막에 Yp ≈ 2Xn 이 되는가?

**답:**
- He-4 하나에 중성자 2개가 들어감
- 중성자가 양성자보다 훨씬 적음 (n/p ≈ 1/7)
- 중성자가 **제한 반응물**이므로, 중성자 양이 헬륨 양을 결정
- 연립방정식을 풀면: $Y_p = 2X_n$

---

# 제13장. 이 모델의 한계

## 13.1 단순화한 것들

이 모델에서는 다음을 단순화했다:

1. **수소와 헬륨-4만 다룸**
   - 그러나 실제로는 D, He-3, Li-7 등도 생성됨 (3차시에서 다룸)

2. **반응률 $\Gamma = \gamma_0 T^5$**
   - 하지만 실제 반응률은 더 복잡한 온도 의존성을 가짐

3. **시간-온도 관계 $t = A/T^2$**
   - 또한 실제로는 물질/복사의 상대적 기여에 따라 달라짐

4. **핵합성 순간 중성자 전부 포획 가정**
   - 마찬가지로 실제로는 일부가 D로 남음 (2차시에서 다룸)

## 13.2 그럼에도 불구하고

그럼에도 불구하고 이 토이 모델은 다음 **핵심 물리**를 올바르게 보여준다:

1. **팽창과 반응의 경쟁** (Γ/H)
2. **동결(freeze-out)** 개념
3. **제한 반응물**에 의한 헬륨 비율 결정
4. **보존법칙**의 역할

따라서 정밀한 예측보다는 물리적 직관을 얻는 데 목적을 두고 이 모델을 활용해야 한다.

---

# 부록 A. 수학 보충 (심화)

## A.1 지수함수 $e^x$

$$e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots$$

**성질:**
- $e^0 = 1$
- $e^{-x} = 1/e^x$
- $e^{a+b} = e^a \times e^b$

**직관적 이해:**
- $e^x$는 "자연스러운 성장"
- $e^{-x}$는 "자연스러운 감소" (미끄럼틀 모양)

## A.2 로그함수 $\ln x$

$$\ln(e^x) = x$$
$$e^{\ln x} = x$$

**반감기와 평균수명의 관계:**
$$\tau = \frac{t_{1/2}}{\ln 2} \approx 1.443 \times t_{1/2}$$

## A.3 델타(Δ) 기호

$$\Delta x = x_{\text{나중}} - x_{\text{처음}}$$

- $\Delta t$: 시간 변화량
- $\Delta T$: 온도 변화량
- $\Delta X_n$: 중성자 분율 변화량

---

# 부록 B. 물리 상수와 환산

## B.1 주요 상수

| 상수 | 기호 | 값 | 단위 |
|-----|-----|-----|------|
| 볼츠만 상수 | $k_B$ | $8.617 \times 10^{-5}$ | eV/K |
| 중성자-양성자 질량차 | $Q$ | 1.293 | MeV |
| 중성자 평균 수명 | $\tau_n$ | 879.4 | 초 |
| 중성자 반감기 | $t_{1/2}$ | 609.8 | 초 |

## B.2 에너지-온도 환산표 (환전표)

| 에너지 | 온도 | 쉽게 말하면 |
|--------|------|------------|
| 1 eV | 11,600 K | 약 1만 도 |
| 0.1 MeV | 1.16 × 10⁹ K | 약 10억 도 |
| 1 MeV | 1.16 × 10¹⁰ K | 약 **100억 도** |
| 10 MeV | 1.16 × 10¹¹ K | 약 1000억 도 |

**어림셈 공식:**
$$T[\text{K}] \approx 10^{10} \times E[\text{MeV}]$$

---

# 부록 C. 참고 자료

## 교과 연결

- **통합과학:** 우주 초기 원소 생성
- **물리학 I:** 핵반응, 보존법칙
- **물리학 II:** 원자핵, 방사성 붕괴
- **수학 I:** 지수함수, 로그함수 (고2)
- **수학:** 연립방정식, 비례/반비례

## 온라인 자료

- [Big Bang Nucleosynthesis - Wikipedia](https://en.wikipedia.org/wiki/Big_Bang_nucleosynthesis)
- [Physics LibreTexts: BBN Predictions](https://phys.libretexts.org/Courses/University_of_California_Davis/Physics_156:_A_Cosmology_Workbook/01:_Workbook/1.23:_Big_Bang_Nucleosynthesis_-_Predictions)
- [볼츠만 상수 - 위키백과](https://ko.wikipedia.org/wiki/볼츠만_상수)
- [Khan Academy: Euler's Method](https://www.khanacademy.org/math/ap-calculus-bc/bc-differential-equations-new/bc-7-5/v/eulers-method)

## 더 읽을거리

- Weinberg, "The First Three Minutes" (최초의 3분)
- 한국천문학회 교육자료
- 한국물리학회 물리교육 자료

---

# Exit Ticket (1차시 점검)

> 수업을 떠나기 전, 다음 질문에 스스로 답해 보자.

1. **동결(freeze-out)이란 무엇인가?**
   - 힌트: 악수 게임 비유에서 "손을 놓치는" 순간을 떠올려 보자.

2. **왜 Γ/H = 1 부근에서 평형이 깨지는가?**
   - 힌트: 두 속도 중 어느 쪽이 우세해지는지 생각해 보자.

3. **최종 헬륨 비율이 왜 $Y_p = 2X_n$이 되는가?**
   - 힌트: He-4 하나를 만들 때 중성자가 몇 개 필요한지 생각해 보자.

답을 말로 설명할 수 있다면, 1차시의 핵심을 이해한 것이다.

---

# 다음 차시 예고 (2차시)

1차시에서는 He-4를 **"중성자 개수 세기"**로 얻었다.
그런데 한 가지 의문이 남는다: 우리는 $T_{\text{nuc}} = 0.07$ MeV를 **그냥 사용**했다.

2차시에서는 다음 질문으로 넘어간다:
- 그 중성자들이 **언제부터** 실제 핵(중수소)을 만들 수 있는가?
- 왜 온도가 충분히 내려가도 중수소가 바로 쌓이지 않는가?

> **핵심 예고:** "온도가 충분히 내려가도 중수소가 바로 쌓이지 않는다. 이것이 **중수소 병목(Deuterium Bottleneck)**이다."

---

*1차시 해설서 끝*
